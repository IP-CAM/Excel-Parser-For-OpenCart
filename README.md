# Excel parser for OpenCart

Приложения для подготовки прайсов, для загрузке прайслистов в интернет магазина разработанный на OpenCart.

## Технические требования

* Windows 7 и выше
* Для сборки и работы приложения необходим утсновленный Microsoft Office 2007 или выше.
* Среда для разработки Visual Studio 2013/2015

## Основной дизайн и бизнес-логика программы обработчика прайсов:

1. Программа может открывать прайс листы
2. Определять тип прайс листа
3. Выполнять анализ выбранного прайс листа в зависимости от типа.
4. После анализа заполнять шаблон ( который находится вот здесь `ExcelParserForOpenCart/Output/Debug/template.xls` или в папке Release и сохранять обработанный прайс лист под именем, который задаёт пользователь.
5. В настоящий момент сделана обработка 3 прайсов (2 союза.xlsx, Каталог OJ 2016_06_01 вер. 6.xls и Прайс ПЬЯНОВ апрель 2016 опт розница.xls).

## Необходимо сделать в общем (при обработки любого нового прайса) :

1. Научить программу определять тип нового прайса, если есть необходимость добавить тип в перечисление  `ExcelParserForOpenCart/UI/EnumPrices.cs`. Определение происходит по уникальниы меткам или уникальной комбинации этих меток.
Определение типа прайса происходит с помощью метода _DetermineTypeOfPriceList_, который находится в файле
 `ExcelParserForOpenCart/UI/ExcelParser.cs` Определение происходит по уникальниы меткам или уникальной комбинации этих меток.
2. Разработать алгоритм для анализа прайса.
Анализ прайса представляет собой обработку структуры прайса и приведение списку, содержащему класс:
 `ExcelParserForOpenCart/UI/OutputPriceLine.cs`
3. Для того, что бы добавить новый анализатор для обработки нового типа прайса необходимо создать новый класс в папке _Prices_ проекта  _ExcelParserForOpenCart_, для удобства был реализован класс с общими методами _GeneralMethods.cs_, для удобства его можно унаследовать.
4. После этого можно использовать новый класс в _ExcelParser.cs_ в методе _DoWorkOpen_

### Нюансы:

Артикул прайса ключевой атрибут сущности товар в базе данных интернет магазина, в который мы загружаем данные прайсы, он должен быть уникальным и алгоритм его формирования должен быть всегда однозначным, т. е. прайслист будут загружать с определённым периодом, по артиклу будет происходить обновление товара.

### Примеры прайсов для обработки:

[PriceExample.zip](https://app.box.com/s/phl77vc86kz1483r35qelsrvj7q1jl4m)

### Пример выходного прайса:

[OutPrice.zip](https://app.box.com/s/icxt0t1yo3boi9qk3zsbz5qybt2y39g3)